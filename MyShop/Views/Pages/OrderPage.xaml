<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="MyShop.Views.Pages.OrderPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:MyShop.Views.Pages"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:controls="using:CommunityToolkit.WinUI.UI.Controls"
    mc:Ignorable="d"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Padding="20" Background="{ThemeResource SystemChromeLowColor}">
            <TextBlock Text="Orders Management" Style="{StaticResource HeaderTextBlockStyle}" Margin="0,0,0,10"/>
            <TextBlock Text="List of all orders" Style="{StaticResource SubtitleTextBlockStyle}" Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"/>
            <StackPanel Orientation="Horizontal" Spacing="10" Margin="0,10,0,0">
                <Button x:Name="AddOrderButton" Content="Add Order" Click="OnAddOrderClicked"/>
            </StackPanel>
        </StackPanel>

        <!-- Date Range Filter -->
        <Border 
            Grid.Row="1"
            Padding="15"
            Margin="20,15,20,0"
            Background="{ThemeResource LayerFillColorDefaultBrush}"
            BorderThickness="1"
            BorderBrush="{ThemeResource ControlElevationBorderBrush}"
            CornerRadius="8">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="180"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="180"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- From Date Label -->
                <TextBlock 
                    Grid.Column="0"
                    Text="From Date:"
                    VerticalAlignment="Center"
                    Margin="0,0,10,0"/>

                <!-- From Date Picker -->
                <CalendarDatePicker
                    x:Name="FromDatePicker"
                    Grid.Column="1"
                    PlaceholderText="Select start date"
                    DateChanged="OnDateRangeChanged"/>

                <!-- Reset From Date Button -->
                <Button 
                    x:Name="ResetFromDateButton"
                    Grid.Column="2"
                    Content="✕"
                    Click="OnResetFromDateClicked"
                    Margin="1,0,0,0"
                    Width="32"
                    Height="32"
                    ToolTipService.ToolTip="Clear start date"
                    Padding="0"/>

                <!-- To Date Label -->
                <TextBlock 
                    Grid.Column="3"
                    Text="To Date:"
                    VerticalAlignment="Center"
                    Margin="20,0,10,0"/>

                <!-- To Date Picker -->
                <CalendarDatePicker
                    x:Name="ToDatePicker"
                    Grid.Column="4"
                    PlaceholderText="Select end date"
                    DateChanged="OnDateRangeChanged"/>

                <!-- Reset To Date Button -->
                <Button 
                    x:Name="ResetToDateButton"
                    Grid.Column="5"
                    Content="✕"
                    Click="OnResetToDateClicked"
                    Margin="1,0,0,0"
                    Width="32"
                    Height="32"
                    ToolTipService.ToolTip="Clear end date"
                    Padding="0"/>
            </Grid>
        </Border>

        <!-- DataGrid Container -->
        <ScrollViewer
            Grid.Row="2"
            Margin="20,15,20,0"
            MaxHeight="530"
            VerticalScrollBarVisibility="Disabled">
            <Border
                Background="{ThemeResource LayerFillColorDefaultBrush}"
                BorderThickness="1"
                BorderBrush="{ThemeResource SystemControlForegroundBaseLowBrush}"
                CornerRadius="4">
                <controls:DataGrid
                    x:Name="OrdersDataGrid"
                    AutoGenerateColumns="False"
                    CanUserReorderColumns="True"
                    CanUserResizeColumns="True"
                    GridLinesVisibility="All"
                    BorderThickness="0"
                    VerticalScrollBarVisibility="Hidden">

                    <controls:DataGrid.Columns>
                        <!-- Order ID Column -->
                        <controls:DataGridTextColumn
                            Header="Order ID"
                            Binding="{Binding OrderId}"
                            Width="80"/>

                        <!-- Created Date Column -->
                        <controls:DataGridTextColumn
                            Header="Created At"
                            Binding="{Binding CreatedTime}"
                            Width="180"/>

                        <!-- Total Amount Column -->
                        <controls:DataGridTextColumn
                            Header="Total Price (₫)"
                            Binding="{Binding FinalPrice}"
                            Width="140"/>

                        <!-- Status Column -->
                        <controls:DataGridTextColumn
                            Header="Status"
                            Binding="{Binding Status}"
                            Width="100"/>

                        <!-- Items Count Column -->
                        <controls:DataGridTextColumn
                            Header="Items"
                            Binding="{Binding OrderItems.Count}"
                            Width="80"/>

                        <!-- Actions Column -->
                        <controls:DataGridTemplateColumn
                            Header="Action"
                            Width="200">
                            <controls:DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <Button Content="View" Height="32" Click="OnViewOrderClicked"/>
                                        <Button Content="Edit" Height="32" Click="OnEditOrderClicked"/>
                                        <Button Content="Delete" Height="32" Click="OnDeleteOrderClicked"/>
                                    </StackPanel>
                                </DataTemplate>
                            </controls:DataGridTemplateColumn.CellTemplate>
                        </controls:DataGridTemplateColumn>
                    </controls:DataGrid.Columns>
                </controls:DataGrid>
            </Border>
        </ScrollViewer>

        <!-- Pagination Controls -->
        <Border 
            Grid.Row="3"
            Padding="20" 
            Background="{ThemeResource LayerFillColorDefaultBrush}"
            BorderThickness="0,1,0,0"
            BorderBrush="{ThemeResource ControlElevationBorderBrush}"
            Margin="20,15,20,20">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Page Info -->
                <TextBlock 
                    Grid.Column="0"
                    x:Name="PageInfoText"
                    Text="Page 1 of 1"
                    VerticalAlignment="Center"
                    FontSize="14"/>

                <!-- Pagination Buttons -->
                <StackPanel 
                    Grid.Column="1"
                    Orientation="Horizontal" 
                    Spacing="10"
                    HorizontalAlignment="Right">
                    <Button 
                        x:Name="PreviousButton"
                        Content="← Previous"
                        Click="OnPreviousPageClicked"
                        IsEnabled="False"/>
                    <Button 
                        x:Name="NextButton"
                        Content="Next →"
                        Click="OnNextPageClicked"
                        IsEnabled="False"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Page>